<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Instructionmodule3 - MSc AI & Engineering Systems Notes">
    <title>Instructionmodule3 - MSc AIES</title>
    <link rel="icon" href="../../../../../../assets/svg/favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="../../../../../../styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Initialize KaTeX
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ]
            });
            
            // Initialize Prism.js syntax highlighting
            if (typeof Prism !== 'undefined') {
                Prism.highlightAll();
            }
            
            // Handle theme switching for Prism.js
            function updatePrismTheme() {
                const isDark = document.body.classList.contains('dark-theme');
                const prismLink = document.querySelector('link[href*="prism"]');
                if (prismLink) {
                    if (isDark) {
                        prismLink.href = 'https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css';
                    } else {
                        prismLink.href = 'https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css';
                    }
                }
            }
            
            // Check initial theme
            updatePrismTheme();
            
            // Listen for theme changes
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        updatePrismTheme();
                    }
                });
            });
            
            observer.observe(document.body, {
                attributes: true,
                attributeFilter: ['class']
            });
        });
    </script>
    <style>
        .note-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }
        .note-header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }
        .note-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            color: var(--text-color);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 400;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        .back-link:hover {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }
        .nav-left {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .breadcrumb-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }
        .folder-path {
             font-size: 0.8rem;
             color: var(--text-color-secondary);
             opacity: 0.7;
         }
         .current-page-title {
             font-size: 1.3rem;
             font-weight: 700;
             color: var(--text-color);
             margin: 0;
             line-height: 1.3;
             letter-spacing: -0.01em;
         }
        .note-content {
            line-height: 1.8;
            color: var(--text-color);
        }
        .note-content h1, .note-content h2, .note-content h3 {
            color: var(--primary-color);
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .note-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            display: block;
        }
        /* Preserve centered images from markdown HTML */
        .note-content div[style*="text-align: center"] {
            text-align: center !important;
        }
        .note-content div[style*="text-align: center"] img {
            margin: 1rem auto;
        }
        .note-content pre {
            background: var(--code-bg);
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
        }
        .note-content code {
            background: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .note-content blockquote {
            border-left: 4px solid var(--primary-color);
            padding-left: 1rem;
            margin: 1rem 0;
            font-style: italic;
            opacity: 0.9;
        }
        .note-content ul, .note-content ol {
            padding-left: 2rem;
            margin: 1rem 0;
        }
        .note-content ul {
            list-style-type: disc;
        }
        .note-content li {
            margin-bottom: 0.2rem;
            display: list-item;
            list-style-position: outside;
        }
        /* Reduce spacing for nested lists */
        .note-content li ul, .note-content li ol {
            margin: 0.3rem 0;
            padding-left: 1.5rem;
        }
        .note-content ul li::marker {
            color: var(--primary-color);
            font-size: 1.2em;
        }
        
        /* Q&A Styles */
        .qa-item {
            margin: 1.5rem 0;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            background: var(--bg-color);
        }
        
        .qa-question {
            padding: 1rem;
            background: var(--secondary-bg, #f8f9fa);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: background-color 0.2s ease;
            user-select: none;
        }
        
        .qa-question:hover {
            background: var(--hover-bg, #e9ecef);
        }
        
        .qa-icon {
            font-size: 0.8rem;
            transition: transform 0.2s ease;
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .qa-question.active .qa-icon {
            transform: rotate(90deg);
        }
        
        .qa-text {
            font-weight: 600;
            color: var(--text-color);
            flex: 1;
        }
        
        .qa-answer {
            padding: 1rem;
            background: var(--bg-color);
            border-top: 1px solid var(--border-color);
            display: none;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .qa-answer.active {
            display: block;
        }
        
        /* Mobile responsive styles */
        @media (max-width: 768px) {
            .note-container {
                padding: 0.5rem;
            }
            .navigation-header {
                padding: 1rem;
                gap: 1rem;
                margin-bottom: 1.5rem;
            }
            .nav-left {
                gap: 1rem;
            }
            .breadcrumb-section {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            .current-page-title {
                font-size: 1.1rem;
                text-align: left;
            }
            .back-link {
                font-size: 0.9rem;
                padding: 0.6rem 1rem;
                min-height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 6px;
                background: var(--border-color);
                color: var(--text-color) !important;
                text-decoration: none;
                border: 1px solid var(--border-color);
                transition: all 0.2s ease;
                flex-shrink: 0;
            }
            .back-link:hover {
                background: var(--primary-color);
                color: white !important;
                border-color: var(--primary-color);
            }
            .folder-path {
                font-size: 0.85rem;
                color: var(--text-color-secondary);
                opacity: 0.8;
                flex: 1;
                min-width: 0;
            }
            .note-navigation {
                width: 100%;
                display: flex;
                align-items: center;
                gap: 0.75rem;
                flex-wrap: nowrap;
            }
            .nav-button {
                font-size: 1.2rem;
                padding: 0.5rem;
                min-height: 40px;
                min-width: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
            }
            .nav-button span:not(.nav-icon) {
                display: none;
            }
            .nav-progress {
                flex: 1;
                font-size: 0.8rem;
                text-align: center;
                color: var(--text-color-secondary);
            }
            .note-header {
                margin-bottom: 1rem;
                padding-bottom: 1.5rem;
            }
            .note-title {
                font-size: 2rem;
            }
            .note-content h1 {
                font-size: 1.8rem;
            }
            .note-content h2 {
                font-size: 1.5rem;
            }
            .note-content h3 {
                font-size: 1.3rem;
            }
            .note-content pre {
                padding: 0.75rem;
                font-size: 0.9rem;
            }
            .note-content ul, .note-content ol {
                padding-left: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
             .note-container {
                 padding: 0.5rem;
             }
             .note-header {
                 margin-bottom: 1.15rem;
                 padding-bottom: 0.75rem;
             }
             .back-link {
                 padding: 0.25rem 0.5rem;
                 font-size: 0.85rem;
             }
         }
        
        /* Navigation header styles */
         .navigation-header {
             display: flex;
             flex-direction: column;
             gap: 1.25rem;
             margin-bottom: 2rem;
             padding: 1.25rem;
             background: transparent;
             border-radius: 0;
             border: none;
             border-bottom: 1px solid var(--border-color);
         }
         
         /* Navigation buttons styles */
         .note-navigation {
             display: flex;
             justify-content: center;
             align-items: center;
             gap: 1rem;
         }
         
         .nav-button {
             display: inline-flex;
             align-items: center;
             justify-content: center;
             padding: 0.6rem;
             background: transparent;
             border: 1px solid var(--border-color);
             border-radius: 4px;
             color: var(--text-color);
             text-decoration: none;
             font-size: 1rem;
             font-weight: 400;
             transition: all 0.2s ease;
             width: 36px;
             height: 36px;
         }
         
         .nav-button:hover {
             color: var(--primary-color);
             border-color: var(--primary-color);
         }
         
         .nav-button:disabled {
             opacity: 0.5;
             cursor: not-allowed;
             pointer-events: none;
         }
         
         .nav-button.prev {
             justify-content: flex-start;
         }
         
         .nav-button.next {
             justify-content: flex-end;
         }
         
         .nav-button-text {
             display: flex;
             flex-direction: column;
             align-items: inherit;
         }
         
         .nav-button-label {
             font-size: 0.75rem;
             opacity: 0.7;
             margin-bottom: 0.2rem;
         }
         
         .nav-button-title {
             font-weight: 500;
             max-width: 200px;
             overflow: hidden;
             text-overflow: ellipsis;
             white-space: nowrap;
         }
         
         .nav-progress {
             display: flex;
             flex-direction: column;
             align-items: center;
             gap: 0.5rem;
             flex: 1;
             margin: 0 1rem;
         }
         
         .nav-progress-text {
             font-size: 0.8rem;
             font-weight: 400;
             color: var(--text-color);
             opacity: 0.7;
             text-align: center;
         }
         
         .nav-progress-bar {
             width: 100%;
             max-width: 200px;
             height: 4px;
             background: #f0f0f0;
             border-radius: 2px;
             overflow: hidden;
         }
         
         .nav-progress-fill {
             height: 100%;
             background: #007acc;
             transition: width 0.3s ease;
         }
         
         @media (max-width: 768px) {
              .note-navigation {
                  flex-direction: row;
                  gap: 0.75rem;
                  align-items: center;
              }
              
              .nav-button {
                  width: 40px;
                  min-width: 40px;
                  height: 40px;
                  border-radius: 50%;
                  padding: 0.5rem;
                  font-size: 1.2rem;
              }
              
              .nav-progress {
                  flex: 1;
                  margin: 0;
              }
              
              .nav-button-title {
                  max-width: none;
              }
          }
          
          /* Jupyter Notebook Styles */
          .code-cell {
              margin: 1.5rem 0;
              border: 1px solid var(--border-color);
              border-radius: 8px;
              overflow: hidden;
              background: var(--bg-color);
          }
          
          .markdown-cell {
              margin: 1.5rem 0;
              padding: 1rem;
              background: var(--bg-color);
              border-radius: 8px;
          }
          
          .input-area {
              background: var(--code-bg, #f8f9fa);
              border-bottom: 1px solid var(--border-color);
          }
          
          .input-area pre {
              margin: 0;
              padding: 1rem;
              background: transparent;
              border-radius: 0;
              overflow-x: auto;
          }
          
          .input-area code {
              background: transparent;
              padding: 0;
              border-radius: 0;
              font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
              font-size: 0.9rem;
              line-height: 1.4;
          }
          
          .output-area {
              background: var(--bg-color);
              padding: 1rem;
          }
          
          .output-stream {
              background: var(--secondary-bg, #f1f3f4);
              padding: 0.75rem;
              margin: 0.5rem 0;
              border-radius: 4px;
              font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
              font-size: 0.85rem;
              line-height: 1.4;
              color: var(--text-color);
              border-left: 3px solid var(--primary-color);
          }
          
          .output-result {
              background: var(--bg-color);
              padding: 0.75rem;
              margin: 0.5rem 0;
              border-radius: 4px;
              font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
              font-size: 0.85rem;
              line-height: 1.4;
              color: var(--text-color);
              border: 1px solid var(--border-color);
          }
          
          .output-image {
              text-align: center;
              margin: 1rem 0;
              padding: 0.5rem;
              background: var(--bg-color);
              border-radius: 4px;
          }
          
          .output-image img {
              max-width: 100%;
              height: auto;
              border-radius: 4px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              margin: 0;
          }
          
          .output-html {
              margin: 0.5rem 0;
              padding: 0.75rem;
              background: var(--bg-color);
              border-radius: 4px;
              border: 1px solid var(--border-color);
              overflow-x: auto;
          }
          
          .output-html table {
              width: 100%;
              border-collapse: collapse;
              margin: 0;
          }
          
          .output-html th,
          .output-html td {
              padding: 0.5rem;
              border: 1px solid var(--border-color);
              text-align: left;
          }
          
          .output-html th {
              background: var(--secondary-bg, #f8f9fa);
              font-weight: 600;
          }
          
          .output-error {
              background: #fef2f2;
              border: 1px solid #fecaca;
              border-radius: 4px;
              margin: 0.5rem 0;
              padding: 0.75rem;
          }
          
          .error-name {
              color: #dc2626;
              font-weight: 600;
              margin: 0 0 0.5rem 0;
              font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
              font-size: 0.9rem;
          }
          
          .error-traceback {
              color: #7f1d1d;
              margin: 0;
              font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
              font-size: 0.8rem;
              line-height: 1.4;
              background: #fef7f7;
              padding: 0.5rem;
              border-radius: 3px;
              overflow-x: auto;
          }
          
          /* Dark theme adjustments for error outputs */
          .dark-theme .output-error {
              background: #2d1b1b;
              border-color: #7f1d1d;
          }
          
          .dark-theme .error-name {
              color: #f87171;
          }
          
          .dark-theme .error-traceback {
              color: #fca5a5;
              background: #1f1515;
          }
          
          /* Dark mode adjustments for Jupyter cells */
          @media (prefers-color-scheme: dark) {
              .input-area {
                  background: var(--code-bg, #2d3748);
              }
              
              .output-stream {
                  background: var(--secondary-bg, #4a5568);
              }
          }
    </style>
</head>
<body>
    <div class="menu-overlay"></div>
    <header>
        <nav class="nav-container">
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-links" id="navLinks">
                <li><a href="../../../../../../index.html">About</a></li>
                <li><a href="../../../../../../journey.html">My Life</a></li>
                <li><a href="../../../../../../projects.html">Projects</a></li>
                <li><a href="../../../../../../blogs.html">Blog</a></li>
                <li><a href="../../../../../../notes.html">MSc AIES</a></li>
                <li><a href="https://dailyclips.es/" target="_blank">Daily Clips</a></li>
                <li><a href="https://alvaromenendez.es/ufc-predictions/" target="_blank">UFC Predictions</a></li>
                <li><a href="../../../../../../acknowledgments.html">Acknowledgments</a></li>
                <li><a href="../../../../../../assets/Alvaro_Menendez_CV.pdf" download>CV</a></li>
            </ul>
            <div class="nav-right">
                <div class="social-links">
                    <a href="https://github.com/DKeAlvaro" target="_blank" aria-label="GitHub">
                        <img src="../../../../../../assets/svg/github.svg" alt="GitHub" class="social-icon">
                    </a>
                    <a href="https://www.linkedin.com/in/alvaromenendezros" target="_blank" aria-label="LinkedIn">
                        <img src="../../../../../../assets/svg/linkedin.svg" alt="LinkedIn" class="social-icon">
                    </a>
                    <a href="mailto:alvaro.mrgr@gmail.com" aria-label="Email">
                        <img src="../../../../../../assets/svg/gmail.svg" alt="Email" class="social-icon">
                    </a>
                </div>
                <div class="theme-toggle" id="themeToggle" aria-label="Toggle theme" role="button" tabindex="0">
                    <img src="../../../../../../assets/svg/moon.svg" alt="Toggle theme" class="theme-icon" id="themeIcon">
                </div>
            </div>
        </nav>
    </header>

    <div class="page-container">
        <div class="content">
            <div class="note-container">
                <div class="navigation-header">
                    <div class="nav-left">
                        <div class="breadcrumb-section">
                            <a href="../../../../../../notes.html" class="back-link">
                                <span>←</span>
                                <span>Back to Notes</span>
                            </a>
                            <span class="folder-path">Year_1 / Q1 / Data_Analysis_&_Learning_Methods / Instructions</span>
                        </div>
                        <div class="current-page-title" id="currentPageTitle"></div>
                    </div>
                    
                    <div class="note-navigation" id="noteNavigation">
                        <a href="#" class="nav-button prev" id="prevButton" style="visibility: hidden;" title="Previous note">
                            <span class="nav-icon">←</span>
                        </a>
                        
                        <div class="nav-progress">
                            <div class="nav-progress-text" id="progressText">Loading...</div>
                            <div class="nav-progress-bar">
                                <div class="nav-progress-fill" id="progressFill" style="width: 0%;"></div>
                            </div>
                        </div>
                        
                        <a href="#" class="nav-button next" id="nextButton" style="visibility: hidden;" title="Next note">
                            <span class="nav-icon">→</span>
                        </a>
                    </div>
                </div>
                
                <div class="note-content">
                    <div class="markdown-cell">
<h1>Instruction Session 3</h1>
<h2>Feature Selection</h2>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
# this cell imports the libraries or packages that you can use during this session

from helpers import *

import numpy as np

# Machine Learning and Decomposition
from sklearn.decomposition import PCA, FastICA
from sklearn.cluster import KMeans


# Statistical tools
from scipy.stats import multivariate_normal
from scipy import linalg

# Visualization
import matplotlib.pyplot as plt
from matplotlib.patches import Ellipse
from matplotlib.colors import ListedColormap, LogNorm

</code></pre>
</div>
</div>
<div class="markdown-cell">
<h2>Part 3.1: Principal Component Analysis (PCA)</h2>
<p>In data science, we often deal with datasets that have many features (high-dimensional data). While having more features can provide richer information, it also makes computation slower, models harder to interpret, and sometimes even hurts performance because of noise and redundancy.  </p>
<p>Principal Component Analysis (PCA) is one of the most common techniques to reduce dimensionality while keeping as much of the data’s “essence” as possible — specifically, its variance. In simple terms, PCA finds a new coordinate system for the data that makes it easier to describe using fewer dimensions.</p>
<p>Here’s the step-by-step intuition for how PCA works:</p>
<ol>
<li>
<p><strong>Compute the covariance matrix</strong><br />
   We start by computing the covariance matrix of the dataset. This matrix tells us how features vary together — high covariance means two features increase or decrease together.</p>
</li>
<li>
<p><strong>Perform eigendecomposition</strong><br />
   Next, we use linear algebra to decompose the covariance matrix into <strong>eigenvalues</strong> and <strong>eigenvectors</strong>.  </p>
</li>
<li>The <strong>eigenvectors</strong> define new directions (axes) in which the data varies the most.  </li>
<li>
<p>The <strong>eigenvalues</strong> tell us how much variance lies along each of these directions.</p>
</li>
<li>
<p><strong>Transform the data (center + rotate)</strong><br />
   Once we have the eigenvectors, we transform the dataset.  </p>
</li>
<li>First, we <strong>center</strong> the data by subtracting its mean (so it is positioned around the origin).  </li>
<li>
<p>Then, we <strong>rotate</strong> the data into the new coordinate system defined by the eigenvectors.<br />
   After this step, the covariance matrix of the transformed data becomes diagonal, meaning the new features are uncorrelated.</p>
</li>
<li>
<p><strong>Select principal components</strong><br />
   Finally, we can choose just the top few components (those corresponding to the largest eigenvalues), effectively compressing the data while preserving most of its variance.</p>
</li>
</ol>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.1.1: Compute eigenvalues and eigenvectors</h3>
</div>
<div class="markdown-cell">
<p>Write a function <code>compute_eigen(X)</code> which computes the eigenvalues and eigenvectors of the covariance matrix of some toy dataset <code>X</code>. The dataset is a matrix of shape ($N\times M$), where $N$ denotes the number of data samples and $M$ the dimensionality of the features. The function should return a vector of length $M$ containing the eigenvalues and a matrix of shape ($M\times M$) containing the corresponding eigenvectors.</p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
# enter your code here
</code></pre>
</div>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
# generate data
X = ex11_generate_data()

# compute eigenvalues and eigenvectors
eigvals, eigvecs = compute_eigen(X)

</code></pre>
</div>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
eigvals
</code></pre>
</div>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
eigvecs
</code></pre>
</div>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
# Run this code
X = ex11_generate_data()

# compute eigenvalues and eigenvectors
eigvals, eigvecs = compute_eigen(X)

# plot data
plt.figure(figsize=(5,5))
plt.scatter(X[:,0], X[:,1], alpha=0.2)
plot_eigen(np.mean(X, axis=0), eigvals, eigvecs, plt.gca(), width=0.1, color="r")
plt.axis("equal")
plt.grid()

# print eigenvalues and eigenvectors
eigvals, eigvecs
</code></pre>
</div>
</div>
<div class="markdown-cell">
<p>Have a look at the computed eigenvalues, eigenvectors and the visualization and answer the questions below:
- In what direction does the first eigenvector point?
- How can the eigenvalue be interpreted?</p>
</div>
<div class="markdown-cell">
<p>Answer: The first eigenvector points in the direction of largest variance. The eigenvalues correspond to the variances along the directions of the eigenvectors</p>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.1.2: Data transformation</h3>
</div>
<div class="markdown-cell">
<p>Write a function <code>transform_PCA(X, mean, eigvecs)</code> which translates some dataset <code>X</code> to be centered in the origin, and rotates it, such that its new covariance matrix is diagonal. $X$ is of shape ($N\times M$), where $N$ denotes the number of data samples and $M$ the dimensionality of the features. The function should return the transformed dataset of shape ($N\times M$). Also create the function <code>inversetransform_PCA(X, mean, eigvecs)</code> which performs the inverse transform.</p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
#// BEGIN_TODO Transform data to PCA space



#// END_TODO 
</code></pre>
</div>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
#// BEGIN_TODO Transform data back from PCA space


    
#// END_TODO
</code></pre>
</div>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
# Run this code
m = np.mean(X, axis=0)
eigvals, eigvecs = compute_eigen(X)
Y = transform_PCA(X, m, eigvecs)
Z = inversetransform_PCA(Y, m, eigvecs)

# plot transformed data
fig, ax = plt.subplots(ncols=2, figsize=(10,5))
ax[0].scatter(Y[:,0], Y[:,1], alpha=0.2)
eigvalsY, eigvecsY = compute_eigen(Y)
plot_eigen(np.mean(Y, axis=0), eigvalsY, eigvecsY, ax[0], width=0.1, color="r")
ax[1].scatter(Z[:,0], Z[:,1], alpha=0.2)
eigvalsZ, eigvecsZ = compute_eigen(Z)
plot_eigen(np.mean(Z, axis=0), eigvalsZ, eigvecsZ, ax[1], width=0.1, color="r")
ax[0].axis("equal"), ax[1].axis("equal")
ax[0].grid(), ax[1].grid();
</code></pre>
</div>
</div>
<div class="markdown-cell">
<p>So far PCA has only been discussed for a toy example. Let's now apply it to high-dimensional data. We will load a dataset containing 400 images of faces. These grayscale images are of size (64 $\times$ 64) and therefore contain 4096 pixels. In order to process the images, they have been flattened into vectors, which are appended to create a matrix containing 400 images. Below we have plotted the first 100 images:</p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
# run this code
X = ex13_generate_data()
plot_faces(X)
</code></pre>
</div>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.1.3: Principal components analysis</h3>
<p>Compute the eigenvalues and vectors of the faces dataset. Plot the first 350 eigenvalues with both a normal as log-scaling on the y-axis.</p>
<blockquote>
<p>Note: Since the dataset only contains 400 images, the covariance matrix of size (4096 $\times$ 4096) is not positive definite (although it should be in theory). Therefore the eigenvalues &gt; 400 are basically useless, however, they are still computed as imaginary quantities. You can plot the real or absolute values of the eigenvalues.</p>
</blockquote>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
#// BEGIN_TODO Plot eigenvalues



#// END_TODO 
</code></pre>
</div>
</div>
<div class="markdown-cell">
<p>Based on the created plots, what do you observe? How could this be useful for data compression?</p>
</div>
<div class="markdown-cell">
<p><code>#// BEGIN_TODO  What do you observe?</code></p>
<p><code>#// END_TODO</code></p>
</div>
<div class="markdown-cell">
<p>Now we will use PCA for data compression. Instead of performing the transform to the PCA space with the entire eigenvector matrix with shape (4096 $\times$ 4096), we only use the $K$ eigenvectors corresponding with the $K$ largest eigenvalues. </p>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.1.4: Data compression</h3>
<p>Compress the faces dataset using PCA in a matrix of shape (400 $\times$ $K$) and then decompress the data and plot the faces using the <code>plot_faces()</code> function. </p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
#// BEGIN_TODO Data compression



#// END_TODO
</code></pre>
</div>
</div>
<div class="markdown-cell">
<p>Analyze the results. What do you observe if you change $K$?</p>
</div>
<div class="markdown-cell">
<p><code>What do you observe?</code></p>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.1.5: PCA with Sklearn</h3>
<p>Compress the faces dataset using PCA class from sklearn library</p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">

</code></pre>
</div>
</div>
<div class="markdown-cell">
<h2>---</h2>
</div>
<div class="markdown-cell">
<h2>Part 3.2: Independent component analysis</h2>
</div>
<div class="markdown-cell">
<p>Another approach of finding the most important components in a dataset is independent component analysis (ICA). Below you will use it to analyze a toy data set.</p>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.2.1: Limitations PCA</h3>
<p>Have a look at the dataset below. Would PCA be a good approach for finding the components of highest variance? Please motivate your answer.</p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
X = ex21_generate_data()
plt.scatter(X[:,0], X[:,1], alpha=0.1)
plt.grid(True)
plt.axis("equal");
</code></pre>
</div>
</div>
<div class="markdown-cell">
<p><code>#// BEGIN_TODO Limitations PCA</code></p>
<p><code>#// END_TODO</code></p>
</div>
<div class="markdown-cell">
<blockquote>
<p>Note: From this moment onwards you can use the <code>FastICA</code> functions from <code>sklearn</code>.</p>
</blockquote>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.2.2: PCA versus ICA</h3>
<p>Use the <code>PCA</code> and <code>FastICA</code> functions from <code>sklearn</code> to create the objects <code>pca_object</code> and <code>ica_object</code>, each with two components. Fit these objects to the dataset and transform the dataset. Save the transformed dataset into the variables <code>data_transformed_pca</code> and <code>data_transformed_ica</code>.</p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
#// BEGIN_TODO PCA and ICA
# create objects


# fit and transform data

#// END_TODO
</code></pre>
</div>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
# run this code
_, ax = plt.subplots(ncols=3, figsize=(15,5))
ax[0].scatter(X[:,0], X[:,1], alpha=0.1)
ax[1].scatter(data_transformed_pca[:,0], data_transformed_pca[:,1], alpha=0.1)
ax[2].scatter(data_transformed_ica[:,0], data_transformed_ica[:,1], alpha=0.1)
plot_pca(ax[0], pca_object, np.mean(X, axis=0))
plot_ica(ax[0], ica_object, np.mean(X, axis=0))
ax[0].grid(True), ax[1].grid(True), ax[2].grid(True)
ax[0].axis('equal'), ax[1].axis('equal'), ax[2].axis('equal')
ax[0].set_title("original data"), ax[1].set_title("transformed data (PCA)"), ax[2].set_title("transformed data (ICA)");
</code></pre>
</div>
</div>
<div class="markdown-cell">
<p>Run your code a couple of times. What do you observe? Which method works best for this data set?</p>
</div>
<div class="markdown-cell">
<p><code>#// BEGIN_TODO PCA versus ICA</code></p>
<p><code>#// END_TODO</code></p>
</div>
<div class="markdown-cell">
<h1>Wrapper and Filter feature selection methods</h1>
</div>
<div class="markdown-cell">
<h2>---</h2>
<h3>Exercise 3.3.1: MI feature selection</h3>
<p><strong>run the code and investigate the optimal number of features needed for you the model, what is an optimal trade off? is this method model dependent or model independent, is it filter method or wrapper method</strong></p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.feature_selection import mutual_info_classif
from sklearn.preprocessing import StandardScaler
import pandas as pd

# ----------------------------------------------------------------------------
# Step 0: Load Breast Cancer Dataset
# ----------------------------------------------------------------------------
data = load_breast_cancer()
X = pd.DataFrame(data.data, columns=data.feature_names)
y = pd.Series(data.target)

# Train/Test split
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42, stratify=y
)

# ----------------------------------------------------------------------------
# Step 0.5: Scale Features (Very Important for Logistic Regression)
# ----------------------------------------------------------------------------
scaler = StandardScaler()
X_train_scaled = pd.DataFrame(scaler.fit_transform(X_train), columns=X_train.columns)
X_test_scaled = pd.DataFrame(scaler.transform(X_test), columns=X_test.columns)

# ----------------------------------------------------------------------------
# Step 1: Compute Mutual Information Scores
# ----------------------------------------------------------------------------
mi_scores = mutual_info_classif(X_train_scaled, y_train, random_state=42)
feature_ranking = np.argsort(mi_scores)[::-1]

# ----------------------------------------------------------------------------
# Step 2: Evaluate Logistic Regression with Top-k Features
# ----------------------------------------------------------------------------
total_features = X_train.shape[1]
accuracy_list = []

for k in range(1, total_features + 1):
    top_k_features = X_train_scaled.columns[feature_ranking[:k]]
    model = LogisticRegression(max_iter=5000, random_state=42)
    model.fit(X_train_scaled[top_k_features], y_train)
    y_pred = model.predict(X_test_scaled[top_k_features])
    accuracy_list.append(accuracy_score(y_test, y_pred))

# ----------------------------------------------------------------------------
# Step 3: Plot Accuracy vs. Number of Features
# ----------------------------------------------------------------------------
plt.figure(figsize=(8,5))
sns.lineplot(
    x=range(1, total_features + 1),
    y=accuracy_list,
    marker="o",
    color="purple"
)
plt.xlabel("Number of Top-k Features (ranked by MI)")
plt.ylabel("Accuracy")
plt.title("Logistic Regression Accuracy vs. Top-k Features (Breast Cancer Dataset)")
plt.xticks(range(1, total_features + 1, 5))
plt.grid(True)
plt.show()
</code></pre>
</div>
</div>
<div class="markdown-cell">
<h3>Exercise 3.3.2: Recursive feature elimination feature selection</h3>
<p><strong>run the following code using the same dataset but with RFE techniuqes for feature selection, how many features would you select, how is it different from MI feature selection, is it model dependent or model independent, is it filter or wrapper method?</strong></p>
</div>
<div class="code-cell">
<div class="input-area">
<pre><code class="language-python">
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.feature_selection import RFE
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score
import pandas as pd

# ----------------------------------------------------------------------------
# Step 0: Load Breast Cancer Dataset
# ----------------------------------------------------------------------------
data = load_breast_cancer()
X = pd.DataFrame(data.data, columns=data.feature_names)
y = pd.Series(data.target)

# Train/Test split
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42, stratify=y
)

# ----------------------------------------------------------------------------
# Step 0.5: Scale Features (Important for Logistic Regression)
# ----------------------------------------------------------------------------
scaler = StandardScaler()
X_train_scaled = pd.DataFrame(scaler.fit_transform(X_train), columns=X_train.columns)
X_test_scaled = pd.DataFrame(scaler.transform(X_test), columns=X_test.columns)

# ----------------------------------------------------------------------------
# Step 1: Recursive Feature Elimination (RFE)
# ----------------------------------------------------------------------------
total_features = X_train_scaled.shape[1]
rfe_accuracy_list = []

for k in range(1, total_features + 1):
    # Base estimator: Logistic Regression
    base_model = LogisticRegression(max_iter=5000, random_state=42)
    
    # Perform RFE to select top-k features
    selector = RFE(estimator=base_model, n_features_to_select=k, step=1)
    selector.fit(X_train_scaled, y_train)
    
    # Select features chosen by RFE
    selected_features = X_train_scaled.columns[selector.support_]
    
    # Retrain logistic regression only on the selected features
    base_model.fit(X_train_scaled[selected_features], y_train)
    
    # Evaluate accuracy on the test set
    y_pred = base_model.predict(X_test_scaled[selected_features])
    rfe_accuracy_list.append(accuracy_score(y_test, y_pred))

# ----------------------------------------------------------------------------
# Step 2: Plot Accuracy vs. Number of Selected Features
# ----------------------------------------------------------------------------
plt.figure(figsize=(8,5))
sns.lineplot(
    x=range(1, total_features + 1),
    y=rfe_accuracy_list,
    marker="o",
    color="green"
)
plt.xlabel("Number of Selected Features (RFE)")
plt.ylabel("Accuracy")
plt.title("Logistic Regression Accuracy vs. Selected Features (RFE)")
plt.xticks(range(1, total_features + 1, 5))
plt.grid(True)
plt.show()
</code></pre>
</div>
</div>
<div class="markdown-cell">
<h1>the end</h1>
</div>
<div class="markdown-cell">
<h2>---</h2>
</div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p id="footerYear"></p>
    </footer>

    <script src="../../../../../../script.js"></script>

    <script>
        // Note navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            loadNoteNavigation();
        });
        
        async function loadNoteNavigation() {
            try {
                // Get current page path relative to root
                const currentPath = window.location.pathname;
                const pathParts = currentPath.split('/');
                const fileName = pathParts[pathParts.length - 1];
                
                // Construct the relative path to match navigation data
                let relativePath = '';
                if (pathParts.includes('notes')) {
                    const notesIndex = pathParts.indexOf('notes');
                    relativePath = pathParts.slice(notesIndex).join('/');
                } else {
                    relativePath = 'notes/' + fileName;
                }
                
                // Decode URL encoding (e.g., %20 -> space) to match navigation data
                relativePath = decodeURIComponent(relativePath);
                
                // Load navigation data
                const response = await fetch('../../../../../../notes_navigation.json');
                if (!response.ok) {
                    console.log('Navigation data not found');
                    return;
                }
                
                const navigationData = await response.json();
                const currentNav = navigationData[relativePath];
                
                if (!currentNav) {
                    console.log('Current page not found in navigation data:', relativePath);
                    return;
                }
                
                // Update progress
                const progressText = document.getElementById('progressText');
                const progressFill = document.getElementById('progressFill');
                const progress = ((currentNav.current_index + 1) / currentNav.total_notes) * 100;
                
                progressText.textContent = `${currentNav.current_index + 1} of ${currentNav.total_notes}`;
                progressFill.style.width = `${progress}%`;
                
                // Update current page title in header
                const currentPageTitle = document.getElementById('currentPageTitle');
                const pageTitle = relativePath.split('/').pop().replace('.html', '').replace(/_/g, ' ');
                currentPageTitle.textContent = pageTitle;
                
                // Update previous button
                const prevButton = document.getElementById('prevButton');
                
                if (currentNav.previous) {
                    prevButton.href = '../../../../../../' + currentNav.previous;
                    prevButton.title = 'Previous: ' + currentNav.previous_title;
                    prevButton.style.visibility = 'visible';
                } else {
                    prevButton.style.visibility = 'hidden';
                }
                
                // Update next button
                const nextButton = document.getElementById('nextButton');
                
                if (currentNav.next) {
                    nextButton.href = '../../../../../../' + currentNav.next;
                    nextButton.title = 'Next: ' + currentNav.next_title;
                    nextButton.style.visibility = 'visible';
                } else {
                    nextButton.style.visibility = 'hidden';
                }
                
                // Add keyboard navigation
                document.addEventListener('keydown', function(e) {
                    if (e.ctrlKey || e.metaKey) return; // Don't interfere with browser shortcuts
                    
                    if (e.key === 'ArrowLeft' && currentNav.previous) {
                        window.location.href = '../../../../../../' + currentNav.previous;
                    } else if (e.key === 'ArrowRight' && currentNav.next) {
                        window.location.href = '../../../../../../' + currentNav.next;
                    }
                });
                
            } catch (error) {
                console.error('Error loading navigation:', error);
                document.getElementById('progressText').textContent = 'Navigation unavailable';
            }
        }
    </script>

</body>
</html>